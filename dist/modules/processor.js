(function(){var fs,isRecordAPIOpen,path,querystring,ui,url,util;ui=require("./ui");util=require("./util");url=require("url");fs=require("fs");path=require("path");querystring=require("querystring");isRecordAPIOpen=false;exports.processData=function(req,data){var d,filePath,position;ui.turnOn();data=data.toString();if(data.indexOf("svdata=")===0){data=data.substring(7)}try{data=JSON.parse(data);req.postData=querystring.parse(req.postData)}catch(_error){return}if(isRecordAPIOpen){filePath=url.parse(req.url).pathname.substr(1);filePath=global.appDataPath+"/"+filePath;d=JSON.stringify(data,null,2);util.guaranteeFilePath(filePath);fs.appendFile(filePath+".json","Url: "+req.url+"\nMethod: "+req.method+"\nPostData: "+JSON.stringify(req.postData,null,2)+"\nReceiveData: "+d+"\n\n\n",function(err){if(err!=null){return console.log(err)}})}if(data.api_result!==1){return}position=url.parse(req.url).pathname.replace("/kcsapi","");switch(position){case"/api_start2":return ui.api_start2(data);case"/api_get_member/basic":ui.api_get_member_basic(data.api_data);return ui.refreshUser();case"/api_get_member/ship2":ui.api_get_member_ship2(data);ui.refreshDecks();return ui.refreshExperience();case"/api_get_member/ship3":ui.api_get_member_ship3(data.api_data);ui.refreshDecks();return ui.refreshExperience();case"/api_get_member/slot_item":return ui.api_get_member_slot_item(data.api_data);case"/api_port/port":ui.api_port_port(data.api_data);ui.refreshUser();ui.refreshDecks();ui.refreshNdocks();return ui.refreshExperience();case"/api_get_member/kdock":ui.api_get_member_kdock(data.api_data);return ui.refreshKdocks();case"/api_req_hokyu/charge":ui.api_req_hokyu_charge(data.api_data);return ui.refreshDecks();case"/api_req_kousyou/createitem":ui.api_req_kousyou_createitem(data.api_data);return ui.refreshCreateitem();case"/api_req_kousyou/getship":ui.api_req_kousyou_getship(data.api_data);return ui.refreshKdocks();case"/api_req_kaisou/slotset":ui.api_req_kaisou_slotset(req.postData,data.api_data);return ui.refreshDecks();case"/api_req_mission/start":ui.api_req_mission_start(req.postData,data.api_data);return ui.refreshDecks();case"/api_req_hensei/change":ui.api_req_hensei_change(req.postData,data.api_data);return ui.refreshDecks()}}}).call(this);