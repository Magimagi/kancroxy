(function(){var copyFile,fs,guaranteeDirPath,guaranteeFilePath,iconv,path,zlib;fs=require("fs");path=require("path");zlib=require("zlib");iconv=require("iconv-lite");iconv.extendNodeEncodings();exports.formatTime=function(time){var hour,minute;hour=Math.floor(time/3600);time-=hour*3600;minute=Math.floor(time/60);time-=minute*60;if(hour<10){hour="0"+hour}if(minute<10){minute="0"+minute}if(time<10){time="0"+time}return hour+":"+minute+":"+time};guaranteeDirPath=function(dirname){var dir;dir=path.dirname(dirname);if(!fs.existsSync(dir)){guaranteeDirPath(dir)}return fs.mkdirSync(dirname)};exports.guaranteeFilePath=guaranteeFilePath=function(filename){var dir;dir=path.dirname(filename);if(!fs.existsSync(dir)){return guaranteeDirPath(dir)}};exports.copyFile=copyFile=function(srcFile,destFile){var data;if(!fs.existsSync(srcFile)){return}data=fs.readFileSync(srcFile);guaranteeFilePath(destFile);return fs.writeFileSync(destFile,data)};exports.isCacheUrl=function(url){return url.indexOf("/kcs/")!==-1&&url.indexOf("Core.swf")===-1&&url.indexOf("mainD2.swf")===-1};exports.modifyPage=function(data,gzip,callback){var s,str;if(gzip){return zlib.gunzip(data,function(err,res){var s,str;if(err){callback(data)}data=res;str=data.toString("euc-jp");if(str.indexOf('<div id="area-game">')===-1){callback(data)}s=str.split('<div id="area-game">');str=s[0]+'<div id="area-game" style="text-align: left;">'+s[1];str=str.replace(' lang="ja"',"");str=str.replace("charset=euc-jp","charset=utf-8");str=str.replace("艦隊これくしょん～艦これ～ - オンラインゲーム - DMM.com","～艦これ～Poi～");return zlib.gzip(str,function(err,result){if(err){callback(data)}return callback(result)})})}else{str=data.toString("euc-jp");if(str.indexOf('<div id="area-game">')===-1){callback(data)}s=str.split('<div id="area-game">');str=s[0]+'<div id="area-game" style="text-align: left;">'+s[1];str=str.replace(' lang="ja"',"");str=str.replace("charset=euc-jp","charset=utf-8");str=str.replace("艦隊これくしょん～艦これ～ - オンラインゲーム - DMM.com","～艦これ～Poi～");return callback(str)}};exports.log=function(text){console.log(text);return global.$("#log-panel-content").text(text)}}).call(this);