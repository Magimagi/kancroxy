(function(){var debug,fs,gui,hide,menu,proxy,quit,show,tray,ui,win;fs=require("fs");gui=window.require("nw.gui");if(process.platform==="darwin"){global.appDataPath=fs.realpathSync(gui.App.dataPath+"/..")+"/poi"}else{global.appDataPath=fs.realpathSync(process.execPath+"/..")}global.$=window.$;global.Notification=window.Notification;global.Notification.requestPermission();global.win=win=gui.Window.get();win.setAlwaysOnTop(true);tray=null;if(process.platform!=="darwin"){tray=new gui.Tray({icon:"icon.png"})}else{tray=new gui.Tray({icon:"icon_16x16.png"})}menu=new gui.Menu;tray.on("click",function(){return win.show()});show=new gui.MenuItem({type:"normal",label:"显示",click:function(){return win.show()}});hide=new gui.MenuItem({type:"normal",label:"隐藏",click:function(){return win.hide()}});debug=new gui.MenuItem({type:"normal",label:"调试",click:function(){return win.showDevTools()}});quit=new gui.MenuItem({type:"normal",label:"退出",click:function(){return win.close(true)}});menu.append(show);menu.append(hide);menu.append(quit);tray.menu=menu;window.tray=tray;win.on("minimize",function(){return this.hide()});win.on("close",function(quit){if(!quit){return this.hide()}else{return this.close(true)}});require("./modules/config").loadConfig();ui=require("./modules/ui");ui.initConfig();ui.api_start2_loadDefault();require("./modules/pac").generatePAC();require("./modules/cache").initCache();proxy=require("./modules/proxy");proxy.createShadowsocksServer();proxy.createServer()}).call(this);
